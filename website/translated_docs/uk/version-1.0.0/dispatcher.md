---
id: version-1.0.0-dispatcher
title: Specification for the interaction of the merchant with the Dispatcher software.
original_id: dispatcher
---

## Оплата на платіжній сторінці процесингу

Для оплаты на платежной странице процессинга необходимо выполнить редирект на страницу процессингово центра, с  POST данными.

**Production url:**   https://pay.concord.ua/api/

POST параметры:
 
| Параметр     | Опис                                                                                                                                                                          | Значение        |
|--------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------|
| operation    | Тип операції                                                                                                                                                                      | Purchase        |
| merchant_id  | ID мерчанта, видається поцесcінгом                                                                                                                                                 |                 |
| amount       | Сума операції. Приклад 500.00                                                                                                                                                     |                 |
| signature    | З метою підтвердження валідності даних повинна бути згенерована і передана в запиті HMAC_MD5 контрольна підпис з використанням SecretKey торговця.                        |                 |
|              | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, order_id, amount, currency_iso, description розділених ";" (Крапка з комою) в кодуванні UTF-8. |                 |
|              | Порядок параметрів при конкатенації важливий!                                                                                                                                        |                 |
| order_id     | Унікальний номер операції на стороні продавця. Якщо операція дублюється - торговець отримує помилку.                                                                              |                 |
| currency_iso | Валюта платежу.                                                                                                                                                                   | UAH             |
| description  | Призначення платежу. Виводиться на платіжній сторінці, при введенні платіжних реквізитів. Відображається в виписці за рахунком і реєстрах                                                   |                 |
| add_params   |Масив з додатковими параметрами. Розширені можливості пошуку потім повертаються Мерчант в callback виклику                                                                     |                 |
| approve_url  | URL для переадресації в разі, якщо платіж успішний                                                                                                                             |                 |
| decline_url  | URL для переадресації в разі, якщо платежі не успішний                                                                                                                            |                 |
| cancel_url   | URL для переадресації в разі, якщо користувач відмовився зробити оплату                                                                                                      |                 |
| callback_url | URL на який прийде інформація про результат виконання платежу                                                                                                                 |                 |
| redirect     | true / false - за замовчуванням true, якщо параметр варто true, тоді клієнт не отримуватиме переадресацію, а отримає url платіжної сторінки                                          | Не обязательный |
| auth_type    | За замовчуванням 1 - покупка, 2-Предавторізація                                                                                                                                       | Не обязательный |


## Callback виклик для відправки повідомлення про статус платежу


Дані відправляються по URL адресою який вказаний в параметрах платежу в поле callback_url.


Дані відправляються на сервер торговця в форматі JSON


Параметры:


| Назва параметра | Опис                                                                                                                                                                | Значения           |
|--------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------|
| merchantAccount    | ID мерчанта                                                                                                                                                             |                    |
| orderReference     | ID операції в системі торговця                                                                                                                                          |                    |
| amount             | Сума операції                                                                                                                                                          |                    |
| currency           | Валюта операції                                                                                                                                                         |                    |
| phone              | Номер телефону клієнта (Якщо включений введення телефону на платіжній сторінці)                                                                                                |                    |
| createdDate        | Дата платежу в форматі YYYY-MM-DD HH:II:SS                                                                                                                              |                    |
|                    | Приклад: 2018-12-14 12:01:26                                                                                                                                             |                    |
| cardPan            | Маскувати PAN карти.                                                                                                                                               |                    |
|                    | Приклад: 535277******0298                                                                                                                                                |                    |
| cardType           | Тип карти                                                                                                                                                             | Visa               |
|                    |                                                                                                                                                                         | MasterCard         |
| fee                | Комісія за операцію                                                                                                                                                   |                    |
| transactionId      | ID транзакції на стороні ПЦ                                                                                                                                             |                    |
| type               | Тип операції. На даний момент параметр не використовується                                                                                                                 |                    |
| recToken           |Токен для рекурентного платежу                                                                                                                                         |                    |
| transactionStatus  | Статус операції                                                                                                                                                         | Approved - Успішно / Declined - Відмова|
| reason             | Текстова причина відмови                                                                                                                                                |                    |
| reasonCode         | Код помилки при відмові                                                                                                                                                |                    |
| merchantSignature  | З метою підтвердження валідності даних повинна бути згенерована і передана в запиті HMAC_MD5 контрольна підпис з використанням SecretKey торговця.                |                    |
|                    | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, orderReference, amount, currency розділених ";" (Крапка з комою) в кодуванні UTF-8. |                    |
|                    | **Порядок параметрів при конкатенації важливий!**                                                                                                                              |                    |


## Рекурентні платежі RecPayment (оплата по токені)

**Production url:**   https://pay.concord.ua/api/


Для здійснення рекуррентного платежу необхідно відправити POST запит з наступними параметрами:

| Назва        | Опис                                                                                                                                                                                          |
|-----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| operation       |  Необхідне значення для даної операції RecPayment                                                                                                                                              |
| merchant_id     | ідентифікатор мерчанта                                                                                                                                                                            |
| amount          | Сума операції. приклад 500.00                                                                                                                                                                    |
| recurring_token | Токен отриманий від ПС                                                                                                                                                                            |
| order_id        | Унікальний номер замовлення в системі торговця                                                                                                                                                        |
| description     | Призначення платежу                                                                                                                                                                               |
| currency_iso    | Валюта. На даний момент тільки UAH                                                                                                                                                               |
| auth_type       | 1 - покупка, 2 - предавторізація. Чи не обов'язковий. За замовчуванням - 1                                                                                                                               |
| signature       | З метою підтвердження валідності даних повинна бути згенерована і передана в запиті HMAC_MD5 контрольна підпис з використанням SecretKey торговця.                                         |
|                 |Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, order_id, amount, recurring_token, currency_iso, description розділених ";" (Крапка з комою) в кодуванні UTF-8. |
|                 | **Порядок параметрів при конкатенації важливий!**                                                                                                                                                        |

В ответ приходят следующие параметры:

| Назва | Параметри                      |
|----------|--------------------------------|
| status   | APPROVED - успешно,            |
|          | DECLINED - операція не успішна|
| code     | код відповіді                     |

## Операція Verify

Для поповнення карти необхідно відправити переадресувати користувача на сторінку платіжного шлюзу методом POST з наступними параметрами:

| Назва | Опис                                                                                                                                                                                  | Тип     |
|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------|
| operation     | тип операції “Verify”                                                                                                                                                                       | String  |
| merchant_id   | ідентифікатор мерчанта                                                                                                                                                                     | String  |
| order_id      | Це унікальний номер операції. Генерується на стороні мерчанта. Він повинен бути унікальним протягом всієї роботи.                                                                       | Integer |
| approve_url   | URL на який буде перенаправлений користувач в разі успішної операції                                                                                                                  | String  |
| decline_url   | URL на який буде перенаправлений користувач в разі не успішної операції                                                                                                               | String  |
| cancel_url    |URL на який буде перенаправлений користувач в разі скасування операції                                                                                                                    | String  |
| signature     | З метою підтвердження валідності даних повинна бути згенерована і передана в запиті HMAC_MD5 контрольна підпис з використанням SecretKey торговця.                                   | String  |
|               |Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, order_id, amount, approve_url, decline_url, cancel_url розділених ";" (Крапка з комою) в кодуванні UTF-8.|         |
|               | **Порядок параметрів при конкатенації важливий!**                                                                                                                                                  |         |

## Операція Reversal
Для перевірки статусу платежу або верифікації карти необхідно відправити POST запит на url https://pay.concord.ua/api/reversal з наступними параметрами:

| Назва | Опис                                                                                                                                                 | Тип     |
|---------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|---------|
| merchant_id   | ідентифікатор мерчанта                                                                                                                                   | String  |
| order_id      | Це унікальний номер операції яка була відправлена ​​в запиті P2PCredit, P2PDebit або Verify                                                            | Integer |
| signature     | З метою підтвердження валідності даних повинна бути згенерована і передана в запиті HMAC_MD5 контрольна підпис з використанням SecretKey торговця. | String  |
|               | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів $merchant_id, $order_id розділених ";" (Крапка з комою) в кодуванні UTF-8.     |         |
|               | **Порядок параметрів при конкатенації важливий!**                                                                                                               |         |

У відповідь повертається JSON з наступними параметрами:

| Назва | Опис                                   | Тип     |
|---------------|--------------------------------------------|---------|
| code          |Код відповіді. (Список кодів відповіді див. нижче) | Integer |
| message       | Текстове повідомлення з результатом запиту  | String  |

## Операція Complete
Для перевірки статусу платежу або верифікації карти необхідно відправити POST запит на url https://pay.concord.ua/api з наступними параметрами:

| Назва | Опис                                                                                                                                                     | Тип     |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|---------|
| merchant_id   | ідентифікатор мерчанта                                                                                                                                       | String  |
| operation     | Complete                                                                                                                                                     | String  |
| order_id      | Це унікальний номер операції яка була відправлена ​​в запиті Purchase                                                                                     | Integer |
| amount        | сума списання                                                                                                                                               |  float  |
| signature     | З метою підтвердження валідності даних повинна бути згенерована і передана в запиті HMAC_MD5 контрольна підпис з використанням SecretKey торговця.     | String  |
|               | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів $ merchant_id, $ order_id, $ amount розділених ";" (Крапка з комою) в кодуванні UTF-8. |         |
|               | **Порядок параметрів при конкатенації важливий!**                                                                                                                  |         |


У відповідь повертається JSON з наступними параметрами:

| Назва | Опис                                   | Тип     |
|---------------|--------------------------------------------|---------|
| code          | Код відповіді. (Список кодів відповіді див. Нижче) | Integer |
| message       | Текстове повідомлення з результатом запиту | String  |


## Операція Check

Для перевірки статусу платежу або веріфікації карти та патенти Відправити POST запит на url https://pay.concord.ua/api/check з наступними параметрами:

| Назва | Опис                                                                                                                                                | Тип     |
|---------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|---------|
| merchant_id   | ідентифікатор мерчанта                                                                                                                                   | String  |
| order_id      | Це унікальний номер операції яка була відправлена ​​в запиті P2PCredit, P2PDebit або Verify                                                            | Integer |
| signature     | З метою підтвердження валідності даних повинна бути згенерована і передана в запиті HMAC_MD5 контрольна підпис з використанням SecretKey торговця. | String  |
|               | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів $merchant_id, $order_id розділених ";" (Крапка з комою) в кодуванні UTF-8.      |         |
|               | **Порядок параметрів при конкатенації важливий!**                                                                                                               |         |


У відповідь повертається JSON з наступними параметрами:

| Назва   | Опис                                   | Тип        |
|-------------------|--------------------------------------------|------------|
| reasoneCode       | Код відповіді. (Список кодів відповіді див. Нижче) | Integer    |
| reason            | опис відповіді                           | String     |
| merchantAccount   | мерчант                                    | String     |
| amount            | сума                                      | String     |
| phone             | Номер телефону                            | String     |
| createdDate       | дата платежу                               | String     |
| cardPan           | Маскований номер карти                  | String     |
| cardType          | Тип карти                                  | String     |
| transactionId     | ідентифікатор транзакції                   | BigInteger |
| message           | Текстове повідомлення з результатом запиту  | String     |
| datetime          | Дата створення операції на сервері          | String     |
| fee               | Комісія платежу                           | Double     |
| transactionStatus | Статус операції (Довідник см нижче)        | String     |

## Операція P2PCredit
Для пополнения карты необходимо отправить POST запрос со следующими параметрами:

| Назва | Опис                                                                                                                                                                             | Тип    |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------|
| operation     | тип операції “P2PCredit”                                                                                                                                                             | String |
| merchant_id   | ідентифікатор мерчанта                                                                                                                                                               | String |
| order_id      | Це унікальний номер операції. Генерується на стороні мерчанта. Він повинен бути унікальним протягом всієї роботи.                                                                | String |
| amount        | Сума операції, повинна бути дробовим числом, c двома знаками після коми. Приклад: 100.50                                                                                          | Double |
| card_number   | Номер картки одержувача.                                                                                                                                                              | String |
| token         | Токен, можна використовувати замість карти одержувача                                                                                                                                    | String |
| currency_iso  | Валюта операції. На даний момент доступна тільки "UAH"                                                                                                                              | String |
| signature     | З метою підтвердження валідності даних повинна бути згенерована і передана в запиті HMAC_MD5 контрольна підпис з використанням SecretKey торговця.                             | String |
|               | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів $merchant_id, $order_id, $amount, card_number, currency_iso розділених ";" (Крапка з комою) в кодуванні UTF-8. |        |
|               |  **Порядок параметрів при конкатенації важливий!**                                                                                                                                           |        |

У відповідь повертається JSON з наступними параметрами:

|  Назва | Опис                                                                              | Тип     |
|---------------|---------------------------------------------------------------------------------------|---------|
| code          | Код ответа. (Список кодов ответа см. ниже Коды ответа P2PCredit)                      | Integer |
| message       | Текстове повідомлення з результатом запиту                                             | String  |
| status        | Статуси операції                                                                      | String  |
|               | APPROVED - переказ  успішний                                                            |         |
|               | DECLINED - переказ не успішний                                                        |         |
|               | ON-PAYMENT - Заявка на переказ  в обробці, необхідно додатково запросити статус |         |
| transactionID | Ідентифікатор транзакції в платіжній системі                                         | Integer |
| approvalCode  | Код авторизації                                                                       | Integer |

## Операція отримання балансу (GetBalance)

Для поповнення карти необхідно відправити POST на url https://pay.concord.ua/api/balance запит з наступними параметрами:
| Назва | Опис                                                                                                                                                 | Тип    |
|---------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|--------|
| operation     | тип операції "GetBalance"                                                                                                                               | String |
| merchant_id   | ідентифікатор мерчанта                                                                                                                                   | String |
| date          | Дата і час запиту в довільному форматі                                                                                                              | String |
| signature     | З метою підтвердження валідності даних повинна бути згенерована і передана в запиті HMAC_MD5 контрольна підпис з використанням SecretKey торговця. | String |
|               | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів $ merchant_id, $ data розділених ";" (Крапка з комою) в кодуванні UTF-8.         |        |
|               | Порядок параметрів при конкатенації важливий!                                                                                                               |        |

У відповідь повертається JSON з наступними параметрами:

| Назва | Опис                     | Тип   |
|----------------|------------------------------|-------|
| mk_deposit     | Лiмiт Mastercard             | Float |
| visa_deposit   | Лiмiт Visa                   | Float |
| mk_available   | Доступний залишок Mastercard | Float |
| visa_available | Доступний залишок Visa       | Float |

## Операція P2PDebit
Для списання коштів з картки необхідно переадресувати користувача на сторінку платіжного шлюзу методом POST з наступними параметрами:

| Назва | Опис                                                                                                                                                                                                             | Тип     |
|---------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------|
| operation     | тип операції "P2PDebit"                                                                                                                                                                                             | String  |
| merchant_id   | ідентифікатор мерчанта                                                                                                                                                                                               | String  |
| order_id      | Це унікальний номер операції. Генерується на стороні мерчанта. Він повинен бути унікальним протягом всієї роботи.                                                                                                | Integer |
| amount        | Сума операції, повинна бути дробовим числом, c двома знаками після коми. Приклад: 100.50                                                                                                                            | Double  |
| currency_iso  | Валюта операції. На даний момент доступна тільки "UAH"                                                                                                                                                             | String  |
| description   | Призначення платежу                                                                                                                                                                                                   | String  |
| approve_url   | URL на який буде перенаправлений користувач в разі успішної операції                                                                                                                                           | String  |
| decline_url   | URL на який буде перенаправлений користувач в разі не успішної операції                                                                                                                                        | String  |
| cancel_url    | URL на який буде перенаправлений користувач в разі скасування операції                                                                                                                                             | String  |
| signature     | З метою підтвердження валідності даних повинна бути згенерована і передана в запиті HMAC_MD5 контрольна підпис з використанням SecretKey торговця.                                                             | String  |
|               | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, order_id, amount, currency_iso, description, approve_url, decline_url, cancel_url розділених ";" (Крапка з комою) в кодуванні UTF-8. |         |
|               |  **Порядок параметрів при конкатенації важливий!**                                                                                                                                                                              |         |

## Операція PurchaseOnMerchant
Для оплати на платіжній сторінці мерчанта необхідно відправити POST запит з наступними даними даними.


**Production url:**   https://pay.concord.ua/api/

POST параметри:

|       Параметр         |       Опис                                                                                                                                                                            |           Значення         |
|----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------|
| operation      | Тип операції                                                                                                                                                                      | PurchaseOnMerchant |
| merchant_id    | ID мерчанта, видається поцесcінгом                                                                                                                                                |                    |
| amount         | Сума операції. приклад 500.00                                                                                                                                                     |                    |
| signature      | З метою підтвердження валідності даних повинна бути згенерована і передана в запиті HMAC_MD5 контрольна підпис з використанням SecretKey торговця.                          |                    |
|                | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, order_id, amount, currency_iso, description розділених ";" (Крапка з комою) в кодуванні UTF-8. |                    |
|                | Порядок параметрів при конкатенації важливий!                                                                                                                                        |                    |
| order_id       | Унікальний номер операції на стороні продавця. Якщо операція дублюється - торговець отримує помилку.                                                                              |                    |
| currency_iso   | Валюта платежу.                                                                                                                                                                   | UAH                |
| description    | Призначення платежу. Виводиться на платіжній сторінці, при введенні платіжних реквізитів. Відображається в виписці за рахунком і реєстрах                                                   |                    |
| add_params     | Масив з додатковими параметрами. Розширені можливості пошуку потім повертаються Мерчант в callback виклику                                                                      |                    |
| token          | Токен для списання з карти без передачі реквізитів картки                                                                                                                         |                    |
| card_num       | Номер картки                                                                                                                                                                      |                    |
| card_exp_month | Термін дії карти MM                                                                                                                                                         |                    |
| card_exp_year  | Термін дії карти YY                                                                                                                                                           |                    |
| card_cvv       | CVV2 код, в разі операції без CVV необхідно вказати -1                                                                                                                         |                    |
| card_holder    | Власник карти. Необов'язкове поле                                                                                                                                             |                    |
| phone          | Номер телефону клієнта. Необов'язкове поле                                                                                                                                      |                    |
| payment_type   | Тип платежу                                                                                                                                                                      |                    |
|                | Purchase - покупка                                                                                                                                                                |                    |
|                | PreAuth - блокування коштів на мапі                                                                                                                                      |                    |
| secure_type    | Тип проходження безпеки транзакції                                                                                                                                           |                    |
|                | Може приймати наступні значення:                                                                                                                                              |                    |
|                | Auto                                                                                                                                                                              |                    |
|                | 3DS                                                                                                                                                                               |                    |
|                | Non3DS                                                                                                                                                                            |                    |
| callback_url   | URL на який прийде інформація про результат виконання платежу                                                                                                                 |                    |

Відповідь:

|    Параметр             |       Опис                                                                      |        Значення                      |
|-----------------|------------------------------------------------------------------------------|------------------------------|
| status          | Статус платежа                                                               | довідник "Статуси платежу" |
| code            | код відповіді                                                                 | Довідник "Коди відповідей"    |
| order_id        | Унікальний номер замовлення в системі торговця                                   |                              |
| amount          | Сума платежу                                                                |                              |
| fee             | Комісія                                                                    |                              |
| currency        | Валюта платежу                                                               |                              |
| token           | Токен для подальших оплат. Токен повернеться в разі, якщо платіж успішний    |                              |
| d3_acs_url      | URL acs сервера на який необхідно відправити користувача для верифікації |                              |
| d3_md           |Унікальний ідентифікатор який необхідно передати на ACS сервер          |                              |
| d3_pareq        | запит який необхідно передати на ACS сервер                             |                              |
| transaction_key | Ключ транзакції, який необхідно використовувати для підтвердження платежу   |                              |
| transaction_id  | Iдентифікатор транзакції                                                     |                              |
| signature       |                                                                              |                              |

Якщо у відповіді code прийшло значення 2001 необхідно провести перевірку 3DS.

Для перевірки 3ds необхідно методом POST відправити форму з параметрами d3_md, d3_pareq, term_url на d3_acs_url.


term_url - url на який повернеться результат перевірки 3DS.

``` html
<form name="MPIform" action='${d3_acs_url}' method="POST">
<input type="hidden" name="PaReq" value='${d3_pareq }'>
<input type="hidden" name="MD" value='${d3_md }'>
<input type="hidden" name="TermUrl" value='${term_url}'>
</form>
```

## Отримання токена для Masterpass
**Production url:**  https://pay.concord.ua/api/mptoken

Для отримання гостьового токена необхідно відправити POST запит з наступними даними даними.
| Параметр  | Опис                                                           |
|-----------|----------------------------------------------------------------------|
| msisdn    | Номер телефону для входу в гаманець Masterpass в форматі 380XXXXXXXXX|
| client_id | Ідентифікатор клієнта в системі MasterPass                           |



У відповідь приходить об'єкт в форматі JSON з наступними параметрами:

| Параметр     | Опис                            |
|--------------|-------------------------------------|
| res          | Результат запиту 0 - все ок        |
| msg          |Повідомлення про помилку                 |
| token        | Токен для передачі в mfs бібліотеку |
| reference_no | Унікальний номер запиту           |

## Проведення платежу через Masterpass

**Production url:**  https://pay.concord.ua/api

Для отримання гостьового токена необхідно відправити POST запит з наступними даними даними.

| Параметр               | Опис                                                                                                                                                                        | Значение           |
|------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------|
| operation              | Тип операції                                                                                                                                                                      | PurchaseMasterpass |
| merchant_id            | ідентифікатор мерчанта                                                                                                                                                            |                    |
| amount                 | Сума платежу в форматі 1.00                                                                                                                                                    |                    |
| order_id               |                                                                                                                                                                                   |                    |
| currency_iso           | Валюта                                                                                                                                                                            | UAH                |
| description            | опис платежу                                                                                                                                                                |                    |
| approve_url            | URL для переадресації після успішного платежу (в разі підтвердження 3DS на сторінці ConcordPay)                                                                                 |                    |
| decline_url            | URL для переадресації потім не успішного платежу (в разі підтвердження 3DS на сторінці ConcordPay)                                                                              |                    |
| cancel_url             | URL для переадресації після скасування платежу (в разі підтвердження 3DS на сторінці ConcordPay)                                                                                   |                    |
| callback_url           | URL-який відправлений callback про статус платежу                                                                                                                         |                    |
| add_params[wallet]     | ознака гаманця                                                                                                                                                                 | masterpass         |
| add_params[msisdn]     | Номер телефону для входаа в гаманець Masterpass в форматі 380XXXXXXXXX                                                                                                             |                    |
| add_params[token]      | Токен отриманий з сервера MasterPass                                                                                                                                            |                    |
| add_params[card_name]  | Alias ​​карти отриманий з сервера MasterPass                                                                                                                                       |                    |
| add_params[client_id]  | Ідентифікатор мерчанта в системі MasterPass                                                                                                                                       |                    |
| add_params[ret_ref_no] | Унікальний номер транзакції отриманий з сервера MasterPass                                                                                                                       |                    |
| signature              | З метою підтвердження валідності даних повинна бути згенерована і передана в запиті HMAC_MD5 контрольна підпис з використанням SecretKey торговця.                          |                    |
|                        | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, order_id, amount, currency_iso, description розділених ";" (Крапка з комою) в кодуванні UTF-8. |                    |
|                        |  **Порядок параметрів при конкатенації важливий!**                                                                                                                                           |                    |


У відповідь приходить об'єкт в форматі JSON з наступними параметрами:
Якщо транзакція вимагає підтвердження 3DS:

| Параметр        | Опис                                                                                                                                                                                                                                    |
|-----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| code            | Код ответа                                                                                                                                                                                                                                    |
| status          | Статус транзакції, якщо необхідна перевірка 3DS, в статусі, буде значення 3ds                                                                                                                                                              |
| d3AcsUrl        | url для перенаправлення клієнта, для перевірки 3ds                                                                                                                                                                                             |
| d3Md            | Криптограма для передачі на хост 3DS                                                                                                                                                                                                         |
| d3Pareq         | Запит для передачі на хост 3DS                                                                                                                                                                                                               |
| transaction_key |Ключ транзакції для підтвердження 3DS                                                                                                                                                                                                         |
| TermUrl         | Url для переадресації після введення коду підтвердження на сторінці 3DS. За замовчуванням url на сторінку ConcordPay, для перевірки 3DS можна вказати свій URL, тоді після проходження 3DS необхідно викликати метод "Підтвердження 3DS верифікації" |

## Підтвердження 3DS верифікації

Для оплати на платіжній сторінці мерчанта необхідно відправити POST запит з наступними даними даними.

**Production url:**   https://pay.concord.ua/api/

| Параметр        | Опис                                                                                                                                                                    | Значение    |
|-----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|
| operation       | Тип операції                                                                                                                                                                | Complete3DS |
| transaction_key | ключ транзакції                                                                                                                                                             |             |
| merchant_id     | ідентифікатор мерчанта                                                                                                                                                      |             |
| d3ds_md         | Ідентифікатор отриманий після редиректу з сервера ACS                                                                                                                      |             |
| d3ds_pares      | Повідомлення отримане після редиректу з сервера ACS                                                                                                                          |             |
| signature       | З метою підтвердження валідності даних повинна бути згенерована і передана в запиті HMAC_MD5 контрольна підпис з використанням SecretKey торговця.                    |             |
|                 | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, transaction_key, d3ds_md, d3ds_pares розділених ";" (Крапка з комою) в кодуванні UTF-8. |             |
|                 |  **Порядок параметрів при конкатенації важливий!**                                                                                                                                 |             |

Відповідь

| Параметр       | Опис                                   | Значення                    |
|----------------|--------------------------------------------|------------------------------|
| status         | Статус платежу                             | довідник “Статуси платежу” |
| code           | Код ответа                                 | довідник “Коди відповідей”    |
| order_id       | Унікальний номер замовлення в системі торговця |                              |
| amount         | Сума платежу                              |                              |
| fee            | Комісія                                   |                              |
| currency       | Валюта платежу                             |                              |
| card_pan       | Маскувати номер карти                  |                              |
| transaction_id | Iдентифікатор транзакції                   |                              |

## Оплата на платіжній сторінці процесингу з розщепленням платежу

Для оплати на платіжній сторінці процесингу необхідно виконати редирект на сторінку процесингового центру, з POST даними.

**Production url:**   https://pay.concord.ua/api/

POST параметри:

|     Параметр         |        Опис                                                                                                                                                                                               | Значення          |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------|
| operation    | Тип операції                                                                                                                                                                                                      | Purchase          |
| merchant_id  | ID мерчанта, видається поцесcінгом                                                                                                                                                                                 |                   |
| amount       | Сума операції. приклад 500.00                                                                                                                                                                                     |                   |
| signature    | З метою підтвердження валідності даних повинна бути згенерована і передана в запиті HMAC_MD5 контрольна підпис з використанням SecretKey торговця.                                                          |                   |
|              | Рядок, що підлягає HMAC_MD5, генерується шляхом конкатенації параметрів merchant_id, order_id, amount, currency_iso, description розділених ";" (Крапка з комою) в кодуванні UTF-8.                                |                   |
|              | Порядок параметрів при конкатенації важливий!                                                                                                                                                                        |                   |
| order_id     | Унікальний номер операції на стороні продавця. Якщо операція дублюється - торговець отримує помилку.                                                                                                              |                   |
| currency_iso | Валюта платежу.                                                                                                                                                                                                   | UAH               |
| description  | Призначення платежу. Виводиться на платіжній сторінці, при введенні платіжних реквізитів. Відображається в виписці за рахунком і реєстрах                                                                                 |                   |
| add_params   | Масив з додатковими параметрами. Розширені можливості пошуку потім повертаються Мерчант в callback виклику                                                                                                      |                   |
| split        | Ознака розщеплення платежу                                                                                                                                                                                       | 0 - не расщеплять |
|              |                                                                                                                                                                                                                   | 1 -  расщеплять   |
| split_rules  | Масив з правилами розщеплення який містить в собі ідентифікатори субмерчанта і суми.                                                                                                                       |                   |
|              | Сума розщеплення повинна збігатися з сумою платежу.                                                                                                                                                              |                   |
|              | Приклад:                                                                                                                                                                                                           |                   |
|              | split_rules[0][sub_merchant_id]=test1&split_rules[0][amount]=100.00&split_rules[1][sub_merchant_id]=test2&split_rules[1][amount]=50.00&.......&split_rules[n][sub_merchant_id]=testn&split_rules[n][amount]=10.00 |                   |
| approve_url  | URL для переадресації в разі, якщо платіж успішний                                                                                                                                                               |                   |
| decline_url  | URL для переадресації в разі, якщо платежі не успішний                                                                                                                                                            |                   |
| cancel_url   | URL для переадресації в разі, якщо користувач відмовився зробити оплату                                                                                                                                      |                   |
| callback_url | URL на який прийде інформація про результат виконання платежу                                                                                                                                                 |                   |


